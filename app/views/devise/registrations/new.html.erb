<%= simple_form_for(resource, as: resource_name, url: registration_path(resource_name), html: { class: 'form-horizontal', data: { controller: "payment" } }) do |f| %>
  <%= f.error_notification %>

  <% if @user.errors.any? %>
    <div class="alert alert-danger">
      <p>Se encontraron errores:</p>
      <ul>
        <% @user.errors.full_messages.each do |message| %>
          <li><%= message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <!-- Paso 1: Información Personal -->
  <div class="step step-active" data-payment-target="step">
    <fieldset class="mb-3">
      <legend>Información personal básica:</legend>
      <%= f.input :full_name, required: true, autofocus: true, input_html: { class: 'form-control' } %>
      <%= f.input :email, required: true, input_html: { class: 'form-control' } %>
      <%= f.input :password, required: true, input_html: { class: 'form-control' }, autocomplete: "new-password" %>
      <%= f.input :password_confirmation, required: true, input_html: { class: 'form-control' }, autocomplete: "new-password" %>
      <%= f.input :phone, input_html: { class: 'form-control' } %>
      <%= f.input :age, input_html: { class: 'form-control' } %>
      <%= f.input :country, as: :select, collection: ['Panamá', 'Colombia', 'Otro'], input_html: { class: 'form-select' } %>
      <%= f.input :city, input_html: { class: 'form-control' } %>
    </fieldset>
    <button type="button" class="btn btn-primary" data-action="click->payment#nextStep">Siguiente</button>
  </div>

 <!-- Paso 2: Selección de Método de Pago y Subir Comprobante -->
<div class="step" data-payment-target="step">
  <fieldset class="mb-3">
    <legend>Método de pago y comprobante:</legend>
    <%= f.input :payment_method, as: :select, collection: [["Yappy", "yappy"], ["ACH", "ach"]], prompt: "Seleccione un método de pago", input_html: { class: 'form-select', data: { action: "change->payment#showPaymentInfo", payment_target: "paymentMethod" } } %>
    <!-- Información para Yappy -->
    <div data-payment-target="yappyInfo" class="d-none">
      <p>Envía tu yappy al 6250-8252</p>
      <%= f.input :payment_option, as: :select, collection: [['Pago Completo', 'full'], ['Pago de Reserva', 'reservation']], prompt: "Seleccione tipo de pago", input_html: { class: 'form-select', data: { action: "change->payment#showPaymentProof", payment_target: "paymentOption" } } %>
      <div data-payment-target="fullPaymentProof" class="d-none">
        <p>Importe: $60 USD</p>
        <label class="btn btn-primary">
          Subir comprobante de pago completo
          <%= f.file_field :full_payment_proof, direct_upload: true, class: 'd-none', data: { action: "change->payment#uploadFile", payment_target: "fileInput" } %>
        </label>
        <img src="" alt="Preview" class="d-none" data-payment-target="filePreview" style="max-width: 200px;">
        <div class="progress d-none" data-payment-target="fullPaymentProgress">
          <div class="progress-bar" role="progressbar" style="width: 0%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
        </div>
      </div>
      <div data-payment-target="reservationPaymentProof" class="d-none">
        <p>Importe: $30 USD</p>
        <label class="btn btn-primary">
          Subir comprobante de pago de reserva
          <%= f.file_field :reservation_payment_proof, direct_upload: true, class: 'd-none', data: { action: "change->payment#uploadFile", payment_target: "fileInput" } %>
        </label>
        <img src="" alt="Preview" class="d-none" data-payment-target="filePreview" style="max-width: 200px;">
        <div class="progress d-none" data-payment-target="reservationPaymentProgress">
          <div class="progress-bar" role="progressbar" style="width: 0%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
        </div>
      </div>
    </div>
    <!-- Información para ACH -->
    <div data-payment-target="achInfo" class="d-none">
      <p>Número de cuenta: 04035458930</p>
      <p>Nombre de la cuenta: Hanaley Mosley</p>
      <p>Tipo de cuenta: Ahorro</p>
      <%= f.input :payment_option, as: :select, collection: [['Pago Completo', 'full'], ['Pago de Reserva', 'reservation']], prompt: "Seleccione tipo de pago", input_html: { class: 'form-select', data: { action: "change->payment#showPaymentProof", payment_target: "paymentOption" } } %>
      <div data-payment-target="fullPaymentProof" class="d-none">
        <p>Importe: $60 USD</p>
        <label class="btn btn-primary">
          Subir comprobante de pago completo
          <%= f.file_field :full_payment_proof, direct_upload: true, class: 'd-none', data: { action: "change->payment#uploadFile", payment_target: "fileInput" } %>
        </label>
        <img src="" alt="Preview" class="d-none" data-payment-target="filePreview" style="max-width: 200px;">
        <div class="progress d-none" data-payment-target="fullPaymentProgress">
          <div class="progress-bar" role="progressbar" style="width: 0%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
        </div>
      </div>
      <div data-payment-target="reservationPaymentProof" class="d-none">
        <p>Importe: $30 USD</p>
        <label class="btn btn-primary">
          Subir comprobante de pago de reserva
          <%= f.file_field :reservation_payment_proof, direct_upload: true, class: 'd-none', data: { action: "change->payment#uploadFile", payment_target: "fileInput" } %>
        </label>
        <img src="" alt="Preview" class="d-none" data-payment-target="filePreview" style="max-width: 200px;">
        <div class="progress d-none" data-payment-target="reservationPaymentProgress">
          <div class="progress-bar" role="progressbar" style="width: 0%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
        </div>
      </div>
    </div>
  </fieldset>
  <%= f.button :submit, "Sign up", class: 'btn btn-primary mt-3' %>
</div>

<% end %>

<%= render "devise/shared/links" %>
